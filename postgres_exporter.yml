pg_stat_statements:
  query: |
    SELECT
      pg_get_userbyid(userid) AS role,
      current_database() AS dbname,
      queryid,
      calls,
      total_exec_time,
      (total_exec_time / NULLIF(calls, 0)) AS mean_exec_time,
      rows
    FROM pg_stat_statements
    WHERE toplevel IS TRUE
    ORDER BY total_exec_time DESC
    LIMIT 200
  metrics:
    - role:            { usage: "LABEL",   description: "Database role (user)" }
    - dbname:         { usage: "LABEL",   description: "Database name" }
    - queryid:         { usage: "LABEL",   description: "Query ID" }
    - calls:           { usage: "COUNTER", description: "Total calls" }
    - total_exec_time: { usage: "COUNTER", description: "Total execution time (ms)" }
    - mean_exec_time:  { usage: "GAUGE",   description: "Mean execution time per call (ms)" }
    - rows:            { usage: "COUNTER", description: "Total rows returned" }